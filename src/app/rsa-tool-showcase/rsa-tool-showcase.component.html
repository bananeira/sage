<app-tool-showcase (toolShowcaseActiveOutput)="setActive($event)" [tool]="rsa"></app-tool-showcase>
<div [ngClass]="{'active' : toolShowcaseActive}" class="content">
    <span class="container">
        <hr>
        <h1>RSA</h1>
        <div [ngClass]="{'hidden' : hideAlertBox}" (click)="setHideAlertBox()" class="altert-box info">
            <span class="heading">
                <h1>info</h1>
                <span class="closing-button">&#10005;</span>
            </span>

            <hr>
            <p>
                The following tool is not available in English. I have decided to write it in German, because I think
                that I can represent natural language aspects more accurately in German, which can be fundamental
                in the following procedure.
            </p>
            <p>
                It should be noted that there may be errors with this tool. I may not have completely purged the
                procedures of sources of error. Despite the small probability that there are flaws, you are very welcome
                to contact me via e-mail (<strong>sora(at)sorata.dev</strong>) if you have found any.
            </p>
            <p>
                For the following tool, it may be helpful if you are already familiar with <strong>residue classes</strong> and
                preferably the basic idea of <strong>asymmetric cryptographic encryption algorithms</strong>.
            </p>
        </div>
        <div class="tabs">
            <input type="radio" name="rsa-procedure" id="with-key" checked="checked">
            <label for="with-key" (click)="resetProcedure()">RSA-Schlüssel</label>
            <div class="tab">
                <p ngNonBindable>Man gebe einen beliebigen ($\text&#123;encrypt&#125;$) Schlüssel $e$ und
                    den dazugehörigen RSA-Modul $N$ an.
                </p>
                <p>$e = $ <input #eWithKey
                                 [ngClass]="{'faulty' : exception == 8 || exception == 1 || exception == 6 || exception == 12}"
                                 (keyup)="setE(eWithKey.value)"
                                 (click)="setE(eWithKey.value)"
                                 class="input">

                    <span class="error" [ngClass]="{'true' : exception == 8 || exception == 1 || exception == 6}"> $e$ ist so zu wählen,
                        dass $1 < e < \varphi (N)$ und $ggT(e, \varphi (N)) = 1$ ($e$ ist teilerfremd zu $\varphi (N)$)
                        gilt.
                    </span>
                    <span class="error" [ngClass]="{'true' : exception == 12}"> Es ist darauf zu achten, dass $e$
                    nicht das 32-Bit-Integer-Limit von $2\:147\:483\:647$ überschreitet.</span>
                </p>
                <p>$N = $ <input #N
                                 [ngClass]="{'faulty' : exception == 11|| exception == 15}"
                                 (keyup)="setN(N.value)"
                                 (click)="setN(N.value)"
                                 class="input">

                    <span class="error" [ngClass]="{'true' : exception == 11}"> $N$ muss $>0$ sein.</span>
                    <span class="error" [ngClass]="{'true' : exception == 15}"> Es ist darauf zu achten, dass $N$
                    nicht das 32-Bit-Integer-Limit von $2\:147\:483\:647$ überschreitet.</span>
                </p>
                <button class="btn-primary" (click)="
                    refreshInputs('with-key', eWithKey.value, '0', '0', N.value)">berechnen</button>
                <hr *ngIf="factorizationProcess && exception != 1">
                <p *ngIf="exception != 1" [mathjax]="factorizationProcess"></p>
                <p *ngIf="exception != 1" [mathjax]="eulerTotientProcess"></p>
                <p *ngIf="exception == 0 || exception == 3" [mathjax]="findingGCDProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="extendGCDProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="findCongurenceProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="displayKeys"></p>
            </div>

            <input type="radio" name="rsa-procedure" id="with-primes">
            <label for="with-primes" (click)="resetProcedure()">Primzahlen</label>
            <div class="tab">
                <p>Man gebe zwei Primzahlen $p$, $q$ und einen beliebigen ($\text&#123;encrypt&#125;$) Schlüssel $e$ an.</p>
                <p>$p = $ <input #p
                                 [ngClass]="{'faulty' : exception == 4 || exception == 9 || exception == 13}"
                                 (keyup)="setPrimeP(p.value)"
                                 (click)="setPrimeP(p.value)"
                                 class="input">
                    <span class="error" [ngClass]="{'true' : exception == 4 || exception == 9}"> $p$ muss $>0$
                        und eine Primzahl sein.
                    </span>
                    <span class="error" [ngClass]="{'true' : exception == 13}"> Es ist darauf zu achten, dass $p$
                    nicht das 32-Bit-Integer-Limit von $2\:147\:483\:647$ überschreitet.</span>
                </p>
                <p>$q = $ <input #q
                                 [ngClass]="{'faulty' : exception == 5 || exception == 10 || exception == 14}"
                                 (keyup)="setPrimeQ(q.value)"
                                 (click)="setPrimeQ(q.value)"
                                 class="input">

                    <span class="error" [ngClass]="{'true' : exception == 5 || exception == 10}"> $q$ muss $>0$
                        und eine Primzahl sein.</span>
                    <span class="error" [ngClass]="{'true' : exception == 13}"> Es ist darauf zu achten, dass $q$
                    nicht das 32-Bit-Integer-Limit von $2\:147\:483\:647$ überschreitet.</span>
                </p>
                <p>$e = $ <input #eWithPrimes
                                 [ngClass]="{'faulty' : exception == 8 || exception == 1 || exception == 6 || exception == 12}"
                                 (keyup)="setE(eWithPrimes.value)"
                                 (click)="setE(eWithPrimes.value)"
                                 class="input">

                    <span class="error" [ngClass]="{'true' : exception == 8 || exception == 1 || exception == 6}"> $e$ ist so zu wählen,
                        dass $1 < e < \varphi (N)$ und $ggT(e, \varphi (N)) = 1$ ($e$ ist teilerfremd zu $\varphi (N)$)
                        gilt.
                    </span>
                    <span class="error" [ngClass]="{'true' : exception == 12}"> Es ist darauf zu achten, dass $e$
                    nicht das 32-Bit-Integer-Limit von $2\:147\:483\:647$ überschreitet.</span>
                    <span class="error" [ngClass]="{'true' :exception == 1}"> Hinweis: $e$ ist $\geq \varphi (N)$.
                    </span>
                </p>
                <button class="btn-primary" (click)="refreshInputs('with-primes', eWithPrimes.value, p.value, q.value, '')">berechnen</button>
                <hr *ngIf="findRSAModulProcess && exception != 1">
                <p *ngIf="exception != 1" [mathjax]="findRSAModulProcess"></p>
                <p *ngIf="exception != 1" [mathjax]="eulerTotientProcess"></p>
                <p *ngIf="exception == 0 || exception == 7" [mathjax]="findingGCDProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="extendGCDProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="findCongurenceProcess"></p>
                <p *ngIf="exception == 0 && extendedGCDList" [mathjax]="displayKeys"></p>
            </div>

        </div>

    </span>
</div>
